{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>БелкаГид</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/main1.css' %}">
    <link rel="stylesheet" href="{% static 'css/main2.css' %}">
    <link rel="stylesheet" href="{% static 'css/main3.css' %}">
    <link rel="stylesheet" href="{% static 'css/main4.css' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'img/favicon-32x32.png' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>


</head>
<body>
<div class="wrapper">
    <div class="content">
        <header>
            <div class="headermenu">
                <div class="logo">
                    <div class="logotype">
                        <div class="nazvanie"><a href="/">БелкаГид</a></div>
                        <a href="/"><img class="imgbelka" src="{% static 'img/белка.png' %}" alt="" width="55"
                                         height="55"></a>
                    </div>

                    <div class="menu">
                        <a href="../../../about">О нас</a>
                        <a href="../../../places">Места</a>
                        <a href="../../../cafe">Кафе и рестораны</a>
                        <a href="../../../shop">Магазин</a>
                        <a href="../../../profile">Личный кабинет</a>
                    </div>
                </div>
            </div>
        </header>

        <div class="namekab">
            <h1>Личный кабинет</h1>
        </div>

        <div class="editmarsr">
            <div class="marsrname">
                <a href="../../../profile/routes" style="display: block; position: relative;">
                    <svg style="margin-top:45px;margin-left:45px;" width="43" height="36" viewBox="0 0 43 36"
                         fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 18H41M2 18L18.25 2M2 18L18.25 34" stroke="#333D29" stroke-width="3"
                              stroke-linecap="round" stroke-linejoin="round"/>

                    </svg>
                </a>
                <h1>{{ route.name }}</h1>
                <svg class="exportm" onclick="saveDisplayChanges()" viewBox="0 0 36 36" fill="none"
                     xmlns="http://www.w3.org/2000/svg">
                    <path d="M22.5 4.5H31.5V13.5" stroke="#333D29" stroke-width="3" stroke-linecap="round"
                          stroke-linejoin="round"/>
                    <path d="M31.5 19.5V30C31.5 30.3978 31.342 30.7794 31.0607 31.0607C30.7794 31.342 30.3978 31.5 30 31.5H6C5.60218 31.5 5.22064 31.342 4.93934 31.0607C4.65804 30.7794 4.5 30.3978 4.5 30V6C4.5 5.60218 4.65804 5.22064 4.93934 4.93934C5.22064 4.65804 5.60218 4.5 6 4.5H16.5"
                          stroke="#333D29" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16.5 19.5L31.5 4.5" stroke="#333D29" stroke-width="3" stroke-linecap="round"
                          stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="allmarsrs">
                {% for st in stops %}
                    <div class="marsr">

                        <svg class="circle3" viewBox="0 0 29 27"
                             fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                  d="M14.1995 3.43647e-05C20.9346 -0.0150583 26.5046 4.94314 28.3187 11.2077C29.9265 16.7599 26.5534 22.2635 21.5623 25.4261C17.2774 28.1413 11.9286 27.0754 7.70787 24.268C3.04259 21.1648 -1.13647 16.5676 0.280474 11.2705C1.95483 5.01114 7.5058 0.0150341 14.1995 3.43647e-05Z"
                                  fill="#A98467"/>
                        </svg>

                        <p>{{ st }}</p>
                        <svg class="deletem" onclick="deleteItem(this)" viewBox="0 0 35 35"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M30.2469 5.19649H25.7532V3.57261C25.7532 1.60269 24.1505 0 22.1805 0H12.8191C10.8491 0 9.24649 1.60269 9.24649 3.57261V5.19643H4.75274C3.0905 5.19643 1.73828 6.54865 1.73828 8.21088V10.3973C1.73828 12.0595 3.0905 13.4118 4.75274 13.4118H4.96137L7.8052 34.0105C7.88354 34.5776 8.36828 35 8.94079 35H26.0586C26.6311 35 27.1159 34.5776 27.1942 34.0105L30.038 13.4118H30.2467C31.9089 13.4118 33.2612 12.0595 33.2612 10.3973V8.21088C33.2614 6.54872 31.9091 5.19649 30.2469 5.19649ZM11.5392 3.57261C11.5392 2.86687 12.1134 2.29265 12.8192 2.29265H22.1805C22.8863 2.29265 23.4605 2.8668 23.4605 3.57261V5.19643H11.5393V3.57261H11.5392ZM25.0598 32.7074H9.9398L7.27582 13.4118H27.7238L25.0598 32.7074ZM30.9687 10.3974C30.9687 10.7954 30.6449 11.1191 30.2469 11.1191C29.3609 11.1191 5.69159 11.1191 4.75274 11.1191C4.35475 11.1191 4.031 10.7954 4.031 10.3974V8.21088C4.031 7.81289 4.35475 7.48914 4.75274 7.48914C5.1268 7.48914 29.3619 7.48914 30.2469 7.48914C30.6449 7.48914 30.9687 7.81289 30.9687 8.21088V10.3974Z"
                                  fill="#333D29"/>
                            <path d="M17.4412 15.7583C16.8082 15.7583 16.2949 16.2715 16.2949 16.9046V28.6791C16.2949 29.3122 16.8082 29.8254 17.4412 29.8254C18.0743 29.8254 18.5876 29.3122 18.5876 28.6791V16.9046C18.5876 16.2715 18.0743 15.7583 17.4412 15.7583Z"
                                  fill="#333D29"/>
                            <path d="M14.3047 28.516L12.6092 16.7415C12.5189 16.1148 11.9384 15.6796 11.3112 15.7702C10.6846 15.8605 10.2497 16.4416 10.34 17.0682L12.0355 28.8427C12.1258 29.4699 12.7075 29.9041 13.3334 29.8139C13.9601 29.7237 14.3949 29.1425 14.3047 28.516Z"
                                  fill="#333D29"/>
                            <path d="M23.689 15.7702C23.0633 15.6799 22.4812 16.1148 22.391 16.7414L20.6954 28.5157C20.6053 29.1423 21.04 29.7235 21.6667 29.8137C22.2927 29.9039 22.8744 29.4695 22.9646 28.8424L24.6602 17.0681C24.7505 16.4415 24.3157 15.8603 23.689 15.7702Z"
                                  fill="#333D29"/>
                        </svg>
                    </div>
                {% endfor %}
            </div>
            <script>
                const places_json = {{ places|safe }};
                $('.allmarsrs').sortable();

                function deleteItem(element) {
                    var currentItem = element.closest('.marsr'); // Находим родительский элемент текущего элемента marsh
                    currentItem.remove(); // Удаляем текущий элемент marsh из DOM
                }

                function saveDisplayChanges() {
                    var stopsInOrder = [];
                    $('.allmarsrs .marsr').each(function () {
                        var stopName = $(this).find('p').text();
                        stopsInOrder.push(getFromDbByName(stopName));
                    });
                    console.log(stopsInOrder); // Выводим имена элементов в порядке, в котором они находятся в .allmarsrs

                    var temproute = "";
                    for (let tempstop = 0; tempstop < stopsInOrder.length; tempstop++) {
                        temproute += stopsInOrder[tempstop].map_id + "$";
                    }
                    exportMapRoute(temproute);
                }

                function getFromDbByName(name) {
                    for (const place of places_json) {
                        if (place.fields.name === name) {
                            return place.fields;
                        }
                    }
                    return null;

                }

                function exportMapRoute(route) {
                    var points = route.split("$").map(Number);
                    points.pop();
                    var tempStr = "";
                    for (let icurr = 0; icurr < points.length; icurr++) {
                        tempStr += places_json[points[icurr]].fields.geo_x + "," + places_json[points[icurr]].fields.geo_y;
                        if (icurr !== points.length - 1) {
                            tempStr += "~";
                        }
                    }
                    var urlExport = "https://yandex.ru/maps/?rtext=" + tempStr + "&rtt=pd";
                    window.open(urlExport);
                }

                function addPlace() {
                    const addValue = document.getElementById("place-add-select").value;
                    if (addValue !== "-1") {
                        const selectedPlace = places_json[addValue];
                        // copy and paste marsh block
                        const newMarsr = $('<div class="marsr">' + '<svg class="circle3" viewBox="0 0 29 27"                              fill="none" xmlns="http://www.w3.org/2000/svg">                             <path fill-rule="evenodd" clip-rule="evenodd"                                   d="M14.1995 3.43647e-05C20.9346 -0.0150583 26.5046 4.94314 28.3187 11.2077C29.9265 16.7599 26.5534 22.2635 21.5623 25.4261C17.2774 28.1413 11.9286 27.0754 7.70787 24.268C3.04259 21.1648 -1.13647 16.5676 0.280474 11.2705C1.95483 5.01114 7.5058 0.0150341 14.1995 3.43647e-05Z"                                   fill="#A98467"/>                         </svg>                          <p>' + selectedPlace.fields.name + '</p>                         <svg class="deletem" onclick="deleteItem(this)" viewBox="0 0 35 35"                              fill="none"                              xmlns="http://www.w3.org/2000/svg">                             <path d="M30.2469 5.19649H25.7532V3.57261C25.7532 1.60269 24.1505 0 22.1805 0H12.8191C10.8491 0 9.24649 1.60269 9.24649 3.57261V5.19643H4.75274C3.0905 5.19643 1.73828 6.54865 1.73828 8.21088V10.3973C1.73828 12.0595 3.0905 13.4118 4.75274 13.4118H4.96137L7.8052 34.0105C7.88354 34.5776 8.36828 35 8.94079 35H26.0586C26.6311 35 27.1159 34.5776 27.1942 34.0105L30.038 13.4118H30.2467C31.9089 13.4118 33.2612 12.0595 33.2612 10.3973V8.21088C33.2614 6.54872 31.9091 5.19649 30.2469 5.19649ZM11.5392 3.57261C11.5392 2.86687 12.1134 2.29265 12.8192 2.29265H22.1805C22.8863 2.29265 23.4605 2.8668 23.4605 3.57261V5.19643H11.5393V3.57261H11.5392ZM25.0598 32.7074H9.9398L7.27582 13.4118H27.7238L25.0598 32.7074ZM30.9687 10.3974C30.9687 10.7954 30.6449 11.1191 30.2469 11.1191C29.3609 11.1191 5.69159 11.1191 4.75274 11.1191C4.35475 11.1191 4.031 10.7954 4.031 10.3974V8.21088C4.031 7.81289 4.35475 7.48914 4.75274 7.48914C5.1268 7.48914 29.3619 7.48914 30.2469 7.48914C30.6449 7.48914 30.9687 7.81289 30.9687 8.21088V10.3974Z"                                   fill="#333D29"/>                             <path d="M17.4412 15.7583C16.8082 15.7583 16.2949 16.2715 16.2949 16.9046V28.6791C16.2949 29.3122 16.8082 29.8254 17.4412 29.8254C18.0743 29.8254 18.5876 29.3122 18.5876 28.6791V16.9046C18.5876 16.2715 18.0743 15.7583 17.4412 15.7583Z"                                   fill="#333D29"/>                             <path d="M14.3047 28.516L12.6092 16.7415C12.5189 16.1148 11.9384 15.6796 11.3112 15.7702C10.6846 15.8605 10.2497 16.4416 10.34 17.0682L12.0355 28.8427C12.1258 29.4699 12.7075 29.9041 13.3334 29.8139C13.9601 29.7237 14.3949 29.1425 14.3047 28.516Z"                                   fill="#333D29"/>                             <path d="M23.689 15.7702C23.0633 15.6799 22.4812 16.1148 22.391 16.7414L20.6954 28.5157C20.6053 29.1423 21.04 29.7235 21.6667 29.8137C22.2927 29.9039 22.8744 29.4695 22.9646 28.8424L24.6602 17.0681C24.7505 16.4415 24.3157 15.8603 23.689 15.7702Z"                                   fill="#333D29"/>                         </svg>');
                        newMarsr.append();
                        newMarsr.appendTo(".allmarsrs");
                        document.getElementById("place-add-select").selectedIndex = 0;

                    }
                }
            </script>


            <select id="place-add-select" class="boxfiltr" onchange="">
                <option disabled selected value=-1> Добавить место</option>
                {% for place in placesNonSerialized %}
                    <option value="{{ place.map_id }}"> {{ place.name }}</option>
                {% endfor %}
            </select>
            <svg onclick="addPlace()" style="margin-left:50px; margin-top:30px; padding-bottom:35px;" width=" 45
            " height="45" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M21.875 17.5H17.5M17.5 17.5H13.125M17.5 17.5V13.125M17.5 17.5V21.875M24.7917 30.625H10.2083C6.98667 30.625 4.375 28.0133 4.375 24.7917V10.2083C4.375 6.98667 6.98667 4.375 10.2083 4.375H24.7917C28.0133 4.375 30.625 6.98667 30.625 10.2083V24.7917C30.625 28.0133 28.0133 30.625 24.7917 30.625Z"
                      stroke="#333D29" stroke-width="2" stroke-linecap="round"/>
            </svg>

        </div>


    </div>


    <div class="footer">
        <div class="logo">
            <div class="logotype">
                <div class="nazvanie"><a href="/">БелкаГид</a></div>
                <a href="/"><img class="imgbelka" src="{% static 'img/белка.png' %}" alt="" width="55"
                                 height="55"></a>
            </div>

            <div class="footermenu">
                <a href="../about">О нас</a>
                <a href="../places">Места</a>
                <a href="../cafe">Кафе и рестораны</a>
                <a href="../shop">Магазин</a>
                <a href="../profile">Личный кабинет</a>
            </div>
        </div>
        <div class="logo">
            <div class="svyzi">
                <div class="svyz">
                    <h1>Телефон</h1>
                    <h2>+7(999)-999-92-92</h2>
                </div>
                <div class="svyz">
                    <h1>Email</h1>
                    <h2>Belkagid@mail.ru</h2>
                </div>
                <div class="svyz">
                    <h1>Соцсети</h1>
                    <div class="managers">
                        <svg width="51" style="margin-top:25px; " height="51" viewBox="0 0 51 51" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M25.5002 4.32227C13.8039 4.32231 4.32231 13.8039 4.32227 25.5002C4.32231 37.1964 13.8039 46.678 25.5002 46.678C37.1964 46.678 46.678 37.1964 46.678 25.5002C46.678 13.8039 37.1964 4.32231 25.5002 4.32227ZM36.4704 13.8342C37.3308 13.8028 37.9821 14.5817 37.633 15.9812L33.437 35.7568C33.1441 37.1622 32.2944 37.4984 31.118 36.8494L24.7251 32.1257C23.2235 33.5856 21.8785 34.8931 21.652 35.1148C21.2958 35.4627 21.0121 35.7545 20.3726 35.7545C19.5439 35.7545 19.685 35.4409 19.3991 34.6518L17.0474 27.4425L10.9012 25.5235C9.53577 25.1052 9.52584 24.1672 11.2078 23.4924L35.851 13.9875C36.062 13.8917 36.2719 13.8414 36.4704 13.8342ZM32.5615 18.0403C32.3762 18.0378 32.1244 18.1041 31.865 18.2614L18.0123 27.0013L20.3461 34.1584L20.8084 29.2324L32.6705 18.5298C32.9959 18.241 32.8704 18.0446 32.5615 18.0403Z"
                                  fill="#333D29"/>
                        </svg>
                        <svg width="46" height="46" style="margin-top:25px; " viewBox="0 0 46 46" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                  d="M23 34.5C29.3513 34.5 34.5 29.3513 34.5 23C34.5 16.6487 29.3513 11.5 23 11.5C16.6487 11.5 11.5 16.6487 11.5 23C11.5 29.3513 16.6487 34.5 23 34.5ZM23 30.6667C27.2341 30.6667 30.6667 27.2341 30.6667 23C30.6667 18.7658 27.2341 15.3333 23 15.3333C18.7658 15.3333 15.3333 18.7658 15.3333 23C15.3333 27.2341 18.7658 30.6667 23 30.6667Z"
                                  fill="#333D29"/>
                            <path d="M34.5007 9.58301C33.4421 9.58301 32.584 10.4411 32.584 11.4997C32.584 12.5582 33.4421 13.4163 34.5007 13.4163C35.5592 13.4163 36.4173 12.5582 36.4173 11.4997C36.4173 10.4411 35.5592 9.58301 34.5007 9.58301Z"
                                  fill="#333D29"/>
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                  d="M3.16944 8.19611C1.91602 10.6561 1.91602 13.8764 1.91602 20.317V25.6837C1.91602 32.1242 1.91602 35.3446 3.16944 37.8045C4.27198 39.9684 6.03125 41.7277 8.19513 42.8302C10.6551 44.0837 13.8754 44.0837 20.316 44.0837H25.6827C32.1233 44.0837 35.3436 44.0837 37.8035 42.8302C39.9674 41.7277 41.7267 39.9684 42.8292 37.8045C44.0827 35.3446 44.0827 32.1242 44.0827 25.6837V20.317C44.0827 13.8764 44.0827 10.6561 42.8292 8.19611C41.7267 6.03223 39.9674 4.27296 37.8035 3.17042C35.3436 1.91699 32.1233 1.91699 25.6827 1.91699H20.316C13.8754 1.91699 10.6551 1.91699 8.19513 3.17042C6.03125 4.27296 4.27198 6.03223 3.16944 8.19611ZM25.6827 5.75033H20.316C17.0325 5.75033 14.8003 5.75332 13.075 5.89427C11.3944 6.03158 10.535 6.28046 9.93543 6.58593C8.49285 7.32098 7.32 8.49382 6.58496 9.9364C6.27948 10.5359 6.0306 11.3954 5.89329 13.076C5.75234 14.8013 5.74935 17.0334 5.74935 20.317V25.6837C5.74935 28.9673 5.75234 31.1992 5.89329 32.9246C6.0306 34.6054 6.27948 35.4648 6.58496 36.0643C7.32 37.5068 8.49285 38.6796 9.93543 39.4147C10.535 39.7202 11.3944 39.9691 13.075 40.1064C14.8003 40.2473 17.0325 40.2503 20.316 40.2503H25.6827C28.9663 40.2503 31.1983 40.2473 32.9237 40.1064C34.6044 39.9691 35.4638 39.7202 36.0633 39.4147C37.5058 38.6796 38.6786 37.5068 39.4137 36.0643C39.7192 35.4648 39.9682 34.6054 40.1054 32.9246C40.2463 31.1992 40.2493 28.9673 40.2493 25.6837V20.317C40.2493 17.0334 40.2463 14.8013 40.1054 13.076C39.9682 11.3954 39.7192 10.5359 39.4137 9.9364C38.6786 8.49382 37.5058 7.32098 36.0633 6.58593C35.4638 6.28046 34.6044 6.03158 32.9237 5.89427C31.1983 5.75332 28.9663 5.75033 25.6827 5.75033Z"
                                  fill="#333D29"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>


</body>
</html>